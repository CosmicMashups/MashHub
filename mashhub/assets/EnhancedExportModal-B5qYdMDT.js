import{r as x,j as e}from"./vendor-react-BqYHFrkR.js";import{u as E,E as o}from"./index-DrdfCScI.js";import{S as C,a as z}from"./Sheet-DSnqxl5f.js";import{X as k,M as F,q as P,n as u,z as f,D as b,H as T}from"./vendor-lucide-Bb8j8FOq.js";import"./vendor-dexie-CKmTJlxL.js";import"./vendor-exceljs-Et7_ggJF.js";import"./vendor-dnd-dosGBBqk.js";import"./vendor-fuse-Dw8P0qyA.js";import"./vendor-motion-DuQQDTmZ.js";function $({isOpen:m,onClose:n,songs:l,projects:i=[]}){const[a,p]=x.useState("songs"),[r,v]=x.useState(""),[t,y]=x.useState("xlsx"),[c,h]=x.useState(!1),N=E();if(!m)return null;const w=async()=>{h(!0);try{if(a==="songs")t==="csv"?await o.exportSongsToCSV(l):t==="xlsx"?await o.exportSongsToXLSX(l):t==="json"&&o.exportToJSON(l);else if(a==="project"&&r){const s=i.find(d=>d.id===r);s&&(t==="xlsx"?await o.exportProjectToXLSX(s):t==="json"&&o.exportProjectToJSON(s))}n()}catch(s){console.error("Export failed:",s),alert("Export failed. Please try again.")}finally{h(!1)}},S=()=>{switch(t){case"csv":return e.jsx(u,{size:20,className:"text-green-600"});case"xlsx":return e.jsx(f,{size:20,className:"text-blue-600"});case"json":return e.jsx(b,{size:20,className:"text-purple-600"})}},g=()=>{switch(t){case"csv":return"Comma-separated values, compatible with Excel and Google Sheets";case"xlsx":return"Excel format with formatting, filters, and multiple sheets";case"json":return"JSON format for developers and data analysis"}},j=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-6 border-b",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-900",children:"Export Data"}),e.jsx("button",{onClick:n,className:"p-2 min-w-[44px] min-h-[44px] flex items-center justify-center text-gray-400 hover:text-gray-600 rounded-md transition-colors disabled:opacity-50",disabled:c,"aria-label":"Close",children:e.jsx(k,{size:20,className:"md:w-6 md:h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"What would you like to export?"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center p-3 min-h-[44px] border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",value:"songs",checked:a==="songs",onChange:s=>p(s.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{size:20,className:"text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"All Songs"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[l.length," songs"]})]})]})]}),i.length>0&&e.jsxs("label",{className:"flex items-center p-3 min-h-[44px] border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",value:"project",checked:a==="project",onChange:s=>p(s.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(P,{size:20,className:"text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Project"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[i.length," projects available"]})]})]})]})]})]}),a==="project"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Project"}),e.jsxs("select",{value:r,onChange:s=>v(s.target.value),className:"w-full px-3 py-2 min-h-[44px] border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"Choose a project..."}),i.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",Object.values(s.sections).flat().length," songs)"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:["csv","xlsx","json"].map(s=>e.jsxs("label",{className:`flex items-center p-3 min-h-[44px] border rounded-lg cursor-pointer transition-colors ${t===s?"border-primary-500 bg-primary-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("input",{type:"radio",value:s,checked:t===s,onChange:d=>y(d.target.value),className:"mr-3 w-5 h-5"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s==="csv"&&e.jsx(u,{size:16,className:"text-green-600"}),s==="xlsx"&&e.jsx(f,{size:16,className:"text-blue-600"}),s==="json"&&e.jsx(b,{size:16,className:"text-purple-600"}),e.jsx("span",{className:"font-medium text-gray-900 uppercase",children:s})]})]},s))}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:g()})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Export Preview"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[S(),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a==="songs"?`All Songs (${l.length} songs)`:r?i.find(s=>s.id===r)?.name||"Selected Project":"No project selected"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Format: ",t.toUpperCase()," â€¢ ",g()]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:space-x-3 p-4 md:p-6 border-t bg-gray-50",children:[e.jsx("button",{onClick:n,className:"btn-secondary w-full sm:w-auto min-h-[44px]",disabled:c,children:"Cancel"}),e.jsxs("button",{onClick:w,disabled:c||a==="project"&&!r,className:"btn-primary flex items-center justify-center space-x-2 w-full sm:w-auto min-h-[44px]",children:[e.jsx(T,{size:16}),e.jsx("span",{children:c?"Exporting...":"Export"})]})]})]});return N?e.jsx(C,{open:m,onOpenChange:n,children:e.jsx(z,{side:"bottom",className:"h-[85vh] p-0 flex flex-col",showDragHandle:!0,children:e.jsx("div",{className:"flex-1 overflow-y-auto bg-white",children:e.jsx(j,{})})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsx(j,{})})})}export{$ as EnhancedExportModal};
